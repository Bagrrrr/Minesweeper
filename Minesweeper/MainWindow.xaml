<Window x:Class="Minesweeper.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Minesweeper"
        mc:Ignorable="d"
        Title="MainWindow" Height="580" Width="550">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="500"/>
        </Grid.RowDefinitions>
        <Border Grid.Row="0" Background="#eda62b"/>


        <Border Grid.Row="1" Background="Yellow" />

        <Grid Grid.Row="0" Width="500" VerticalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                <Label Content="Mines Left:" Foreground="DarkSlateGray" FontWeight="Bold"/>
                <Label Content="{Binding MinesLeft}" FontWeight="Bold" ContentStringFormat="D3"/>
            </StackPanel>

            <Button Grid.Column="1" x:Name="StartGameButton" 
                Content="Start Game" 
                Width="100" Height="30" 
                Command="{Binding StartCommand}"/>

            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <Label Content="Time:" Foreground="DarkSlateGray"
                       FontWeight="Bold"/>
                <Label Content="{Binding ElapsedTime}" 
                   FontWeight="Bold" 
                   ContentStringFormat="{}{0:mm\:ss}"/>
            </StackPanel>
        </Grid>

        <Grid Grid.Row="1">
            <Viewbox Stretch="UniformToFill" Opacity="1">
                <Canvas Width="500" Height="500">

                    <Path Fill="#ff0000" 
                  Data="M 0 0 L 0 161.88676 L 11.746053 158.38982 L 17.818551 139.65297 L 28.99668 155.86956 L 48.692635 155.85457 L 36.723857 171.49703 L 42.824259 190.22405 L 24.249166 183.67509 L 8.3235229 195.26405 L 8.812382 175.5743 L 0 169.18192 L 0 418.49694 L 10.777637 404.1836 L 21.788334 443.73571 L 60.612321 457.08786 L 26.398905 479.78157 L 26.053707 499.99997 L 301.95004 499.99997 L 289.54098 483.43406 L 267.59142 484.31617 L 280.24233 466.35758 L 272.62109 445.75522 L 293.60999 452.23751 L 310.84873 438.62284 L 311.16964 460.58739 L 329.44552 472.77528 L 308.65455 479.86787 L 302.99598 499.99997 L 440.59378 499.99997 L 431.82274 474.3235 L 391.44277 462.99189 L 424.99886 437.83426 L 423.29768 395.92932 L 457.59326 420.06893 L 496.92161 405.50186 L 484.56164 445.57849 L 499.99997 465.10959 L 499.99997 294.54946 L 488.70764 307.61378 L 483.11521 280.59889 L 457.69093 269.89102 L 481.65535 256.22415 L 483.98286 228.73539 L 499.99997 243.31228 L 499.99997 17.647502 L 463.71898 24.747327 L 447.89411 61.207117 L 428.58056 26.468669 L 389.01553 22.68492 L 410.11605 0 L 177.16025 0 L 190.39355 10.696505 L 171.52235 15.257467 L 164.58065 33.389176 L 154.41125 16.850651 L 135.02225 15.852262 L 147.60856 1.0697021 L 147.32072 0 L 0 0 z M 483.35551 0 L 499.99997 14.706596 L 499.99997 0 L 483.35551 0 z M 61.521309 13.91698 L 64.534045 42.784985 L 90.022929 56.669409 L 63.498966 68.455253 L 58.17061 96.986845 L 38.765076 75.403149 L 9.98337 79.152275 L 24.514266 54.026676 L 12.054045 27.812256 L 40.440426 33.8677 L 61.521309 13.91698 z M 108.64195 450.48671 L 118.86923 460.88866 L 133.2358 458.36117 L 126.50339 471.30198 L 133.3469 484.18492 L 118.95863 481.78093 L 108.82126 492.27021 L 106.66171 477.84318 L 93.552946 471.44358 L 106.60641 464.93183 L 108.64195 450.48671 z M 499.99997 478.639 L 468.63444 479.10977 L 454.7154 499.99997 L 499.99997 499.99997 L 499.99997 478.639 z " />

                    <Path Fill="#338030" 
                  Data="M 0 0 L 0 5.4503133 L 41.525631 22.509737 L 76.014482 0 L 0 0 z M 81.421387 0 L 78.077405 44.127539 L 115.4312 74.234745 L 68.812854 85.569971 L 51.721908 130.39979 L 26.535331 89.565592 L 0 88.235958 L 0 150.20892 L 4.9216634 148.99762 L 16.5809 118.15299 L 33.971053 146.16937 L 66.908577 147.7269 L 45.637524 172.9233 L 54.334668 204.73014 L 23.798031 192.28594 L 0 207.91392 L 0 384.3631 L 2.4572144 377.6338 L 31.977376 424.01546 L 86.920793 425.99209 L 51.931197 468.39983 L 60.956486 499.99997 L 93.476465 499.99997 L 93.502303 483.18704 L 68.977702 466.25319 L 97.336178 457.08786 L 105.86227 428.53043 L 123.34234 452.66849 L 153.13639 451.95278 L 135.58191 476.03658 L 144.0093 499.99997 L 283.28503 499.99997 L 279.76639 493.57452 L 241.13412 489.63058 L 267.7635 461.36615 L 259.5764 423.4062 L 294.68641 439.99795 L 328.25852 420.48131 L 323.32858 458.99989 L 352.26429 484.89805 L 314.10744 492.11208 L 310.62342 499.99997 L 408.6133 499.99997 L 406.20001 486.85452 L 336.57635 455.66159 L 403.68544 419.37285 L 411.83688 343.51753 L 467.08725 396.12828 L 499.99997 389.21242 L 499.99997 306.22989 L 471.34952 334.43695 L 465.65736 288.66403 L 424.72395 267.40383 L 466.49711 247.84585 L 474.0677 202.34579 L 499.99997 230.06864 L 499.99997 44.303239 L 471.3888 45.394645 L 434.75227 103.23453 L 411.12839 38.972815 L 344.79859 22.002791 L 372.77466 0 L 183.5273 0 L 183.39036 1.0495483 L 206.79461 22.105627 L 175.8456 27.874784 L 163.05258 56.64047 L 148.00234 28.988928 L 116.69107 25.711092 L 138.33833 2.8525391 L 137.73061 0 L 81.421387 0 z M 0 14.827519 L 0 61.981746 L 9.6707275 50.592261 L 0 14.827519 z M 117.13962 494.89796 L 110.46044 499.99997 L 132.75986 499.99997 L 117.13962 494.89796 z " />

                    <Path Stroke="Green" StrokeThickness="10" Data="M -0.00013894918 264.30314 L 57.740013 312.66906 L 254.42831 258.07282 L 178.1231 447.39938 L 212.95646 500 " />
                    <Path Stroke="Green" StrokeThickness="10" Data="M 499.9999,335.27755 487.88904,375.70396 420.2558,282.1291 304.82876,284.79475 372.92391,191.55551 334.71981,82.601597 444.43817,118.55142 500.00024,76.189304" />

                    <Path Stroke="Green" StrokeThickness="10" Data="m 295.79129,113.39714 -44.78451,43.76761 10.66569,61.70494 -55.46465,-29.06768 -55.38901,29.21155 10.50548,-61.73241 -44.89797,-43.65121 61.95738,-9.08506 27.64054,-56.189477 27.78629,56.117537 z" />
                </Canvas>

            </Viewbox>

            <ItemsControl ItemsSource="{Binding Cells}" Grid.Row="1" Margin="10">
                
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Rows="10" Columns="10"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Button Command="{Binding DataContext.RevealCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                CommandParameter="{Binding}"
                                Content="{Binding DisplayText}"
                                FontSize="18" FontWeight="Bold">
                            <Button.InputBindings>
                                <MouseBinding MouseAction="RightClick" 
                                              Command="{Binding DataContext.FlagCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                              CommandParameter="{Binding}" />
                            </Button.InputBindings>
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Margin" Value="1"/>

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsRevealed}" Value="True">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="IsEnabled" Value="False"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsFlagged}" Value="True">
                                            <Setter Property="Foreground" Value="OrangeRed"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding NeighborMines}" Value="1">
                                            <Setter Property="Foreground" Value="Blue"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding NeighborMines}" Value="2">
                                            <Setter Property="Foreground" Value="Green"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding NeighborMines}" Value="3">
                                            <Setter Property="Foreground" Value="Red"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>         
        </Grid>
    </Grid>
</Window>
